Notebook[{
Cell[BoxData[GridBox[{
   {
    RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"fname", "=", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"$TemporaryDirectory", ",", "\"\<stockageD1.txt\>\""}], 
          "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
      RowBox[{"s", "=", 
       RowBox[{"OpenWrite", "[", "fname", "]"}]}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"H", "[", 
        RowBox[{"a_", ",", "b_", ",", "g_", ",", "x_", ",", "y_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"Cos", "[", "a", "]"}], ",", 
            RowBox[{"Sin", "[", "a", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", 
             RowBox[{"Sin", "[", "a", "]"}]}], ",", 
            RowBox[{"Cos", "[", "a", "]"}]}], "}"}]}], "}"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cos", "[", "b", "]"}], ",", "0", ",", 
            RowBox[{"-", 
             RowBox[{"Sin", "[", "b", "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sin", "[", "b", "]"}], ",", "0", ",", 
            RowBox[{"Cos", "[", "b", "]"}]}], "}"}]}], "}"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cos", "[", "g", "]"}], ",", 
            RowBox[{"Sin", "[", "g", "]"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Sin", "[", "g", "]"}]}], ",", 
            RowBox[{"Cos", "[", "g", "]"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], ".", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "f"}], ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"1", "/", "f"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], ".", 
        RowBox[{"{", 
         RowBox[{"x", ",", " ", "y", ",", " ", "1"}], "}"}]}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"D1", "[", 
        RowBox[{
        "a1_", ",", "a2_", ",", "b1_", ",", "b2_", ",", "g1_", ",", "g2_", 
         ",", "x1_", ",", "x2_", ",", "y1_", ",", "y2_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"H", "[", 
           RowBox[{"a1", ",", "b1", ",", "g1", ",", "x1", ",", "y1"}], "]"}], 
          "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", 
         RowBox[{
          RowBox[{"H", "[", 
           RowBox[{"a2", ",", "b2", ",", "g2", ",", "x2", ",", "y2"}], "]"}], 
          "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"H", "[", 
           RowBox[{"a2", ",", "b2", ",", "g2", ",", "x2", ",", "y2"}], "]"}], 
          "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", 
         RowBox[{
          RowBox[{"H", "[", 
           RowBox[{"a1", ",", "b1", ",", "g1", ",", "x1", ",", "y1"}], "]"}], 
          "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"D2", "[", 
        RowBox[{
        "a1_", ",", "a2_", ",", "b1_", ",", "b2_", ",", "g1_", ",", "g2_", 
         ",", "x1_", ",", "x2_", ",", "y1_", ",", "y2_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"H", "[", 
           RowBox[{"a1", ",", "b1", ",", "g1", ",", "x1", ",", "y1"}], "]"}], 
          "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", 
         RowBox[{
          RowBox[{"H", "[", 
           RowBox[{"a2", ",", "b2", ",", "g2", ",", "x2", ",", "y2"}], "]"}], 
          "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"H", "[", 
           RowBox[{"a2", ",", "b2", ",", "g2", ",", "x2", ",", "y2"}], "]"}], 
          "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", 
         RowBox[{
          RowBox[{"H", "[", 
           RowBox[{"a1", ",", "b1", ",", "g1", ",", "x1", ",", "y1"}], "]"}], 
          "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"D3", "[", 
        RowBox[{
        "a1_", ",", "a2_", ",", "b1_", ",", "b2_", ",", "g1_", ",", "g2_", 
         ",", "x1_", ",", "x2_", ",", "y1_", ",", "y2_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"H", "[", 
           RowBox[{"a1", ",", "b1", ",", "g1", ",", "x1", ",", "y1"}], "]"}], 
          "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", 
         RowBox[{
          RowBox[{"H", "[", 
           RowBox[{"a2", ",", "b2", ",", "g2", ",", "x2", ",", "y2"}], "]"}], 
          "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"H", "[", 
           RowBox[{"a2", ",", "b2", ",", "g2", ",", "x2", ",", "y2"}], "]"}], 
          "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", 
         RowBox[{
          RowBox[{"H", "[", 
           RowBox[{"a1", ",", "b1", ",", "g1", ",", "x1", ",", "y1"}], "]"}], 
          "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Write", "[", 
       RowBox[{"s", ",", 
        RowBox[{"FortranForm", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{
            "1", ",", "0", ",", "0", ",", " ", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0", ",", "0"}], "]"}], "[", "D3", "]"}], 
          "[", 
          RowBox[{
          "a1", ",", "a2", ",", "b1", ",", "b2", ",", "g1", ",", "g2", ",", 
           "x1", ",", "x2", ",", "y1", ",", "y2"}], "]"}], "]"}]}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Write", "[", 
       RowBox[{"s", ","}], "   ", "]"}], "\[IndentingNewLine]", 
      RowBox[{"Write", "[", 
       RowBox[{"s", ",", 
        RowBox[{"FortranForm", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{
            "0", ",", "1", ",", "0", ",", " ", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0", ",", "0"}], "]"}], "[", "D3", "]"}], 
          "[", 
          RowBox[{
          "a1", ",", "a2", ",", "b1", ",", "b2", ",", "g1", ",", "g2", ",", 
           "x1", ",", "x2", ",", "y1", ",", "y2"}], "]"}], "]"}]}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Write", "[", 
       RowBox[{"s", ","}], "   ", "]"}], "\[IndentingNewLine]", 
      RowBox[{"Write", "[", 
       RowBox[{"s", ",", 
        RowBox[{"FortranForm", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{
            "0", ",", "0", ",", "1", ",", " ", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0", ",", "0"}], "]"}], "[", "D3", "]"}], 
          "[", 
          RowBox[{
          "a1", ",", "a2", ",", "b1", ",", "b2", ",", "g1", ",", "g2", ",", 
           "x1", ",", "x2", ",", "y1", ",", "y2"}], "]"}], "]"}]}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Write", "[", 
       RowBox[{"s", ","}], "   ", "]"}], "\[IndentingNewLine]", 
      RowBox[{"Write", "[", 
       RowBox[{"s", ",", 
        RowBox[{"FortranForm", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", " ", "1", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0", ",", "0"}], "]"}], "[", "D3", "]"}], 
          "[", 
          RowBox[{
          "a1", ",", "a2", ",", "b1", ",", "b2", ",", "g1", ",", "g2", ",", 
           "x1", ",", "x2", ",", "y1", ",", "y2"}], "]"}], "]"}]}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Write", "[", 
       RowBox[{"s", ","}], "   ", "]"}], "\[IndentingNewLine]", 
      RowBox[{"Write", "[", 
       RowBox[{"s", ",", 
        RowBox[{"FortranForm", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", " ", "0", ",", "1", ",", "0", ",", 
             "0", ",", "0", ",", "0", ",", "0"}], "]"}], "[", "D3", "]"}], 
          "[", 
          RowBox[{
          "a1", ",", "a2", ",", "b1", ",", "b2", ",", "g1", ",", "g2", ",", 
           "x1", ",", "x2", ",", "y1", ",", "y2"}], "]"}], "]"}]}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Write", "[", 
       RowBox[{"s", ","}], "   ", "]"}], "\[IndentingNewLine]", 
      RowBox[{"Write", "[", 
       RowBox[{"s", ",", 
        RowBox[{"FortranForm", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", " ", "0", ",", "0", ",", "1", ",", 
             "0", ",", "0", ",", "0", ",", "0"}], "]"}], "[", "D3", "]"}], 
          "[", 
          RowBox[{
          "a1", ",", "a2", ",", "b1", ",", "b2", ",", "g1", ",", "g2", ",", 
           "x1", ",", "x2", ",", "y1", ",", "y2"}], "]"}], "]"}]}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Write", "[", 
       RowBox[{"s", ","}], "   ", "]"}], "\[IndentingNewLine]", 
      RowBox[{"Write", "[", 
       RowBox[{"s", ",", 
        RowBox[{"FortranForm", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", " ", "0", ",", "0", ",", "0", ",", 
             "1", ",", "0", ",", "0", ",", "0"}], "]"}], "[", "D3", "]"}], 
          "[", 
          RowBox[{
          "a1", ",", "a2", ",", "b1", ",", "b2", ",", "g1", ",", "g2", ",", 
           "x1", ",", "x2", ",", "y1", ",", "y2"}], "]"}], "]"}]}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Write", "[", 
       RowBox[{"s", ","}], "   ", "]"}], "\[IndentingNewLine]", 
      RowBox[{"Write", "[", 
       RowBox[{"s", ",", 
        RowBox[{"FortranForm", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", " ", "0", ",", "0", ",", "0", ",", 
             "0", ",", "1", ",", "0", ",", "0"}], "]"}], "[", "D3", "]"}], 
          "[", 
          RowBox[{
          "a1", ",", "a2", ",", "b1", ",", "b2", ",", "g1", ",", "g2", ",", 
           "x1", ",", "x2", ",", "y1", ",", "y2"}], "]"}], "]"}]}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Write", "[", 
       RowBox[{"s", ","}], "   ", "]"}], "\[IndentingNewLine]", 
      RowBox[{"Write", "[", 
       RowBox[{"s", ",", 
        RowBox[{"FortranForm", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", " ", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "1", ",", "0"}], "]"}], "[", "D3", "]"}], 
          "[", 
          RowBox[{
          "a1", ",", "a2", ",", "b1", ",", "b2", ",", "g1", ",", "g2", ",", 
           "x1", ",", "x2", ",", "y1", ",", "y2"}], "]"}], "]"}]}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Write", "[", 
       RowBox[{"s", ","}], "   ", "]"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Write", "[", 
        RowBox[{"s", ",", 
         RowBox[{"FortranForm", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", 
             RowBox[{
             "0", ",", "0", ",", "0", ",", " ", "0", ",", "0", ",", "0", ",", 
              "0", ",", "0", ",", "0", ",", "1"}], "]"}], "[", "D3", "]"}], 
           "[", 
           RowBox[{
           "a1", ",", "a2", ",", "b1", ",", "b2", ",", "g1", ",", "g2", ",", 
            "x1", ",", "x2", ",", "y1", ",", "y2"}], "]"}], "]"}]}], "]"}], 
       RowBox[{"Close", "[", "s", "]"}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"FilePrint", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"$TemporaryDirectory", ",", "\"\<stockageD1.txt\>\""}], 
         "}"}], "]"}], "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]"}]}]},
   {"\[Placeholder]"},
   {"\[Placeholder]"},
   {"\[Placeholder]"}
  }]], "Input",
 CellChangeTimes->{{3.69676296793038*^9, 3.6967629724027452`*^9}, {
   3.69676306123615*^9, 3.696763104310396*^9}, {3.696763478770403*^9, 
   3.696763479652165*^9}, {3.69676353020253*^9, 3.69676353247285*^9}, {
   3.696763576644438*^9, 3.6967636380863533`*^9}, {3.696766611854769*^9, 
   3.696766700365356*^9}, {3.6967667364247017`*^9, 3.6967667478100357`*^9}, {
   3.6967668261449385`*^9, 3.696766904846882*^9}, {3.696766942519476*^9, 
   3.696767216477533*^9}, {3.696767247676549*^9, 3.6967672923156123`*^9}, {
   3.696767336075794*^9, 3.696767355668588*^9}, {3.696767395426679*^9, 
   3.6967676399149733`*^9}, {3.696768347848325*^9, 3.696768405467716*^9}, {
   3.696768449653146*^9, 3.6967684529609814`*^9}, {3.696768617217882*^9, 
   3.6967686378457546`*^9}, {3.6967687113974185`*^9, 3.696768712115566*^9}, {
   3.696768748870589*^9, 3.6967687619301157`*^9}, {3.696768861603546*^9, 
   3.696768878464828*^9}, {3.696768939485862*^9, 3.6967689622048345`*^9}, 
   3.696769229807328*^9, {3.6967694180224485`*^9, 3.6967694741821675`*^9}, {
   3.6967695653017683`*^9, 3.696769567523148*^9}, {3.6967695979715776`*^9, 
   3.696769659560466*^9}, {3.696769813492406*^9, 3.696769823797599*^9}, {
   3.6967699369508677`*^9, 3.6967699636315985`*^9}, {3.696770173724492*^9, 
   3.696770178162899*^9}, {3.696770220786851*^9, 3.6967702250447917`*^9}, 
   3.696770262132777*^9, {3.6967708400092583`*^9, 3.6967708493639216`*^9}, {
   3.69677264402954*^9, 3.696772682209134*^9}, {3.696772723025737*^9, 
   3.6967727240810676`*^9}, {3.6967727553403454`*^9, 
   3.6967727650257645`*^9}, {3.6967728504949265`*^9, 
   3.6967728512061415`*^9}, {3.6967730210567455`*^9, 3.696773066234898*^9}, {
   3.696773154648782*^9, 3.6967731944614897`*^9}, {3.6967734782191887`*^9, 
   3.6967735404109025`*^9}, {3.696773579096467*^9, 3.6967736331637793`*^9}, {
   3.6967736654473553`*^9, 3.696773701208481*^9}, {3.6967737757891483`*^9, 
   3.6967738227743034`*^9}, {3.69677395846792*^9, 3.6967739599780016`*^9}, {
   3.6967814598039813`*^9, 3.696781466064433*^9}, {3.6967818536489553`*^9, 
   3.6967818564062023`*^9}, 3.69678561437503*^9, {3.696785783551839*^9, 
   3.6967857928748074`*^9}, {3.6967859162022095`*^9, 
   3.6967859204155383`*^9}, {3.6967861089571266`*^9, 
   3.6967861137722244`*^9}, {3.6967862567260056`*^9, 
   3.6967862610519714`*^9}, {3.696786956018779*^9, 3.696786960405255*^9}, {
   3.6967870093904343`*^9, 3.6967872147849207`*^9}, {3.6967873088701954`*^9, 
   3.6967873181193666`*^9}, {3.696787365271855*^9, 3.6967874334113092`*^9}, {
   3.6967874919240723`*^9, 3.6967875677568293`*^9}, {3.696787746330013*^9, 
   3.6967877720308714`*^9}, {3.6967879595364685`*^9, 
   3.6967879727151065`*^9}, {3.697207037140356*^9, 3.6972070750808764`*^9}, {
   3.697267484210318*^9, 3.6972675064347076`*^9}}]
},
WindowSize->{1350, 685},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
